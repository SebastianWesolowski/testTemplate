import { promises, constants } from 'fs';
import path from 'path';

/**
 * Checks if a folder exists at the given path.
 * If the folder does not exist and createFolder is true, it creates the folder.
 * @param {string} folderPath - The path of the folder to check.
 * @param {boolean} createFolder - If true, create the folder if it doesn't exist.
 * @returns {Promise<boolean>} - Returns true if the folder exists or is created successfully, otherwise false.
 */
async function isFolderExist({ folderPath, createFolder, }) {
    try {
        const folders = folderPath.split(path.sep);
        for (let i = 1; i <= folders.length; i++) {
            const partialPath = path.join(...folders.slice(0, i));
            try {
                await promises.access(partialPath, constants.R_OK | constants.W_OK);
            }
            catch (error) {
                if (error.code === 'ENOENT' && createFolder) {
                    await promises.mkdir(partialPath);
                }
                else {
                    throw error;
                }
            }
        }
        return true;
    }
    catch (error) {
        console.error(`Error checking or creating folder: ${error.message}`);
        return false;
    }
}

export { isFolderExist };
